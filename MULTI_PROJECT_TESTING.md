# Тестирование многопроектной функциональности CRM Системы

## Обзор реализованной функциональности

Система теперь поддерживает многопроектную архитектуру со следующими возможностями:

### 1. Выбор проекта в боковом меню
- В верхней части бокового меню добавлен раздел "ВЫБОР ПРОЕКТА"
- Доступны опции:
  - **"Все проекты"** - показывает данные по всем проектам
  - **Конкретные проекты** - показывает данные только по выбранному проекту
- Кнопка **"Новый проект"** для быстрого создания проектов

### 2. Предустановленные проекты
Система инициализируется с тремя тестовыми проектами:

1. **Жилой комплекс "Солнечный"**
   - Клиент: ООО "Инвест Строй"
   - Статус: В работе (50% завершено)
   - Бюджет: 50 млн руб.

2. **Торговый центр "Метрополис"**
   - Клиент: АО "Торговые Инвестиции"
   - Статус: Планирование (10% завершено)
   - Бюджет: 150 млн руб.

3. **Офисное здание "Бизнес Парк"**
   - Клиент: ООО "Офис Девелопмент"
   - Статус: В работе (65% завершено)
   - Бюджет: 80 млн руб.

### 3. Адаптированные страницы
Следующие страницы автоматически фильтруют данные по выбранному проекту:

- **Dashboard** - статистика и графики
- **Проекты** - список проектов
- **Материалы** - складские остатки
- **Сотрудники** - команда проекта
- **Финансы** - бюджеты и счета

## Инструкции по тестированию

### Шаг 1: Запуск приложения
```bash
npm run dev
```

### Шаг 2: Вход в систему
Используйте любой из предустановленных аккаунтов:

**Администратор:**
- Email: `admin@construction-crm.ru`
- Пароль: `admin123`

**Менеджер проектов:**
- Email: `manager@construction-crm.ru`
- Пароль: `manager123`

**Прораб:**
- Email: `foreman@construction-crm.ru`
- Пароль: `foreman123`

**Бухгалтер:**
- Email: `accountant@construction-crm.ru`
- Пароль: `accountant123`

### Шаг 3: Тестирование выбора проектов

#### Тест 1: Просмотр всех проектов
1. В боковом меню выберите **"Все проекты"**
2. Откройте **Dashboard** - должна отображаться общая статистика по всем проектам
3. Откройте **Проекты** - должны быть видны все 3 проекта
4. Откройте **Материалы** - полный список материалов
5. Откройте **Финансы** - все финансовые данные

#### Тест 2: Выбор конкретного проекта
1. В боковом меню выберите **"Жилой комплекс 'Солнечный'"**
2. Проверьте изменения в Dashboard:
   - Заголовок должен показывать название проекта
   - Статистика должна измениться (меньше цифры)
   - Отображается информация о клиенте и прогрессе
3. Откройте **Проекты** - должен быть только выбранный проект
4. Откройте **Материалы** - уменьшенный список материалов
5. Откройте **Финансы** - данные только по этому проекту

#### Тест 3: Переключение между проектами
1. Выберите **"Торговый центр 'Метрополис'"**
2. Убедитесь, что данные обновились во всех разделах
3. Переключитесь на **"Офисное здание 'Бизнес Парк'"**
4. Снова проверьте обновление данных
5. Вернитесь к **"Все проекты"** - данные должны показать общую картину

#### Тест 4: Создание нового проекта
1. В разделе "ВЫБОР ПРОЕКТА" нажмите **"Новый проект"**
2. Заполните форму создания проекта:
   - Название: "Тестовый проект"
   - Клиент: "Тестовый клиент"
   - Адрес: "Тестовый адрес"
   - Тип: любой
   - Бюджет: любая сумма
   - Даты: любые валидные даты
3. Нажмите **"Создать проект"**
4. Новый проект должен автоматически выбраться
5. Проверьте, что он появился в списке проектов

### Шаг 4: Проверка функциональности страниц

#### Dashboard
- ✅ Заголовок отображает название выбранного проекта
- ✅ Статистика соответствует выбранному проекту
- ✅ Графики обновляются при переключении
- ✅ Чипы с информацией о клиенте и прогрессе

#### Страница проектов
- ✅ Фильтрация проектов по выбору
- ✅ Создание новых проектов
- ✅ Редактирование проектов
- ✅ Удаление проектов
- ✅ Автоматическое обновление списка доступных проектов

#### Материалы
- ✅ Количества материалов изменяются для конкретного проекта
- ✅ При "Все проекты" показываются полные остатки
- ✅ При выборе проекта остатки уменьшаются (симуляция)

#### Финансы
- ✅ Счета фильтруются по проекту
- ✅ Бюджеты соответствуют выбранному проекту
- ✅ Транзакции показывают только релевантные

#### Сотрудники
- ✅ Страница обновляется при переключении проектов
- ✅ В реальном приложении здесь была бы фильтрация по команде проекта

### Шаг 5: Проверка состояния приложения

#### Сохранение выбора
- ✅ Выбранный проект сохраняется при перезагрузке страницы
- ✅ Состояние проектов сохраняется в localStorage

#### Навигация
- ✅ При переходе между страницами проект остается выбранным
- ✅ Все ссылки работают корректно
- ✅ Данные обновляются автоматически

#### Производительность
- ✅ Переключение между проектами происходит мгновенно
- ✅ Нет лишних API запросов
- ✅ Данные кешируются локально

## Развертывание на Netlify

### Подготовка к деплою
1. Убедитесь, что проект собирается без ошибок:
```bash
npm run build
```

2. Папка `dist` содержит готовые файлы для деплоя

### Настройка Netlify
1. Подключите репозиторий к Netlify
2. Настройки сборки:
   - Build command: `npm run build`
   - Publish directory: `dist`
   - Node version: 18 или новее

3. Переменные окружения (при необходимости):
   - `NODE_VERSION=18`

### Проверка деплоя
После успешного деплоя проверьте:
- ✅ Страница логина загружается
- ✅ Аутентификация работает
- ✅ Выбор проектов функционирует
- ✅ Все страницы доступны
- ✅ Данные корректно фильтруются

## Архитектурные особенности

### Состояние приложения
- **ProjectSelectionStore** - управляет выбранным проектом и списком доступных проектов
- **Фильтрация данных** - все stores автоматически фильтруют данные по selectedProjectId
- **Персистентность** - выбор проекта сохраняется между сессиями

### Компоненты
- **ProjectSelector** - компонент выбора проекта в сайдбаре
- **ProjectCreationModal** - модальное окно для создания проектов
- **Адаптивные страницы** - все основные страницы поддерживают проектную фильтрацию

### Расширяемость
Для добавления новых страниц с поддержкой проектов:
1. Импортируйте `useProjectSelectionStore`
2. Добавьте `selectedProjectId` в dependencies useEffect
3. Фильтруйте данные на основе selectedProjectId

## Известные ограничения

1. **Mock данные** - система использует симулированные данные
2. **Простая фильтрация** - в реальном приложении нужна связь через projectId в базе данных
3. **Ограниченная интеграция** - не все компоненты полностью интегрированы

## Следующие шаги

Для production готовности рекомендуется:
1. Интеграция с реальной базой данных
2. API для управления проектами
3. Более детальная фильтрация данных
4. Система ролей на уровне проектов
5. Оптимизация производительности для больших объемов данных