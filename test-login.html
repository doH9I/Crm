<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn-test { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-danger { background: #dc3545; color: white; }
    </style>
</head>
<body>
    <h1>üîê –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –≤—Ö–æ–¥–∞ Construction CRM</h1>
    
    <div class="test-section">
        <h2>–¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:</h2>
        <div id="users-list">
            <div><strong>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</strong> admin@construction-crm.ru / admin123</div>
            <div><strong>–ú–µ–Ω–µ–¥–∂–µ—Ä:</strong> manager@construction-crm.ru / manager123</div>
            <div><strong>–ú–∞—Å—Ç–µ—Ä:</strong> foreman@construction-crm.ru / foreman123</div>
            <div><strong>–ë—É—Ö–≥–∞–ª—Ç–µ—Ä:</strong> accountant@construction-crm.ru / accountant123</div>
        </div>
    </div>

    <div class="test-section">
        <h2>–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã:</h2>
        <button class="btn-test" onclick="testUser('admin@construction-crm.ru', 'admin123')">
            –¢–µ—Å—Ç –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        </button>
        <button class="btn-test" onclick="testUser('manager@construction-crm.ru', 'manager123')">
            –¢–µ—Å—Ç –ú–µ–Ω–µ–¥–∂–µ—Ä–∞
        </button>
        <button class="btn-test" onclick="testUser('wrong@email.com', 'wrong')">
            –¢–µ—Å—Ç –Ω–µ–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        </button>
    </div>

    <div class="test-section">
        <h2>–†—É—á–Ω–æ–π —Ç–µ—Å—Ç:</h2>
        <input type="email" id="email" placeholder="Email" style="width: 200px; padding: 8px; margin: 5px;">
        <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" style="width: 200px; padding: 8px; margin: 5px;">
        <button class="btn-test" onclick="testManual()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ö–æ–¥</button>
    </div>

    <div id="results" class="test-section">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:</h2>
        <div id="log"></div>
    </div>

    <script>
        // –≠–º—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏ –≤—Ö–æ–¥–∞ –∏–∑ store
        const users = [
            {
                id: '1',
                email: 'admin@construction-crm.ru',
                password: 'admin123',
                name: '–ì–ª–∞–≤–Ω—ã–π –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                role: 'admin',
                permissions: ['*']
            },
            {
                id: '2',
                email: 'manager@construction-crm.ru',
                password: 'manager123',
                name: '–ú–µ–Ω–µ–¥–∂–µ—Ä –ü—Ä–æ–µ–∫—Ç–æ–≤',
                role: 'manager',
                permissions: ['projects', 'estimates', 'employees', 'reports']
            },
            {
                id: '3',
                email: 'foreman@construction-crm.ru',
                password: 'foreman123',
                name: '–ú–∞—Å—Ç–µ—Ä –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞',
                role: 'foreman',
                permissions: ['projects', 'materials', 'tools', 'employees']
            },
            {
                id: '4',
                email: 'accountant@construction-crm.ru',
                password: 'accountant123',
                name: '–ì–ª–∞–≤–Ω—ã–π –ë—É—Ö–≥–∞–ª—Ç–µ—Ä',
                role: 'accountant',
                permissions: ['finances', 'estimates', 'reports']
            }
        ];

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.style.padding = '5px';
            entry.style.margin = '2px 0';
            entry.style.borderRadius = '3px';
            
            if (type === 'success') {
                entry.style.background = '#d4edda';
                entry.innerHTML = `[${timestamp}] ‚úÖ ${message}`;
            } else if (type === 'error') {
                entry.style.background = '#f8d7da';
                entry.innerHTML = `[${timestamp}] ‚ùå ${message}`;
            } else {
                entry.style.background = '#e2e3e5';
                entry.innerHTML = `[${timestamp}] ‚ÑπÔ∏è ${message}`;
            }
            
            logDiv.appendChild(entry);
            entry.scrollIntoView();
        }

        async function testLogin(email, password) {
            log(`–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞: ${email}`);
            
            // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
            await new Promise(resolve => setTimeout(resolve, 500));
            
            const foundUser = users.find(u => u.email === email && u.password === password);
            
            if (foundUser) {
                log(`–í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${foundUser.name} (${foundUser.role})`, 'success');
                log(`–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞: ${foundUser.permissions.join(', ')}`, 'info');
                return true;
            } else {
                log(`–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è: ${email}`, 'error');
                return false;
            }
        }

        async function testUser(email, password) {
            await testLogin(email, password);
        }

        async function testManual() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            if (!email || !password) {
                log('–í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å', 'error');
                return;
            }
            
            await testLogin(email, password);
        }

        // –ê–≤—Ç–æ—Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            log('–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'info');
            log(`–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ: ${users.length}`, 'info');
        };
    </script>
</body>
</html>